services:
  cliproxyapi:
    image: eceasy/cli-proxy-api:latest
    container_name: cliproxyapi
    restart: unless-stopped
    environment:
      - MANAGEMENT_STATIC_PATH=/CLIProxyAPI/static
    volumes:
      - ./config/config.yaml:/tmp/repo-config.yaml:ro
      - cliproxyapi_config:/CLIProxyAPI
      - cliproxyapi_static:/CLIProxyAPI/static
      - cliproxyapi_home:/root/.cli-proxy-api
    command: sh -c "[ -f /CLIProxyAPI/config.yaml ] || cp /tmp/repo-config.yaml /CLIProxyAPI/config.yaml; exec ./CLIProxyAPI"

volumes:
  cliproxyapi_config:
  cliproxyapi_static:
  cliproxyapi_home:
